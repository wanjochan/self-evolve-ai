# Self-Evolve AI 项目规划

## 1. 项目愿景

创建一个能够真正自我进化的AI系统，通过代码自我修改、编译和优化实现持续进化，最终目标是实现完全自主的智能系统。

## 来自人类的意见参考
自举编译和AI协同进化、跨硬件架构

本项目自进化范式：用Loader+Runtime+Program的结构，通过多代自举和AI驱动的进化，逐步构建出完整的自进化计算机软件系统

- Loader-{arch}.exe 负责加载Runtime-{arch} + Program.wasm，目前主要是操作系统内引导，未来不排除继续演化出操作系统。（注意，第零代的是tinycc编译的C程序loader0.c，之后进化出可执行程序后不再使用）
- Runtime 是架构依赖二进制，封装硬件架构和ABI等，实现WASM虚拟机。特别注意那些PE/MachO/ELF头不在Runtime而是在Loader上的了
- Program 是平台无关程序（WASM格式的二进制模块）

Runtime和Program两种编译的二进制是不一样的。Program编译的是.wasm（WebAssembly标准格式），Runtime编译的是平台适配的二进制（由WASM二次编译，而且不需要PE/ELF/MACHO头）

其中 Loader+Runtime 或 Loader+Runtime+Program 可以根据需要，分开打包或合成打包

## 2. 系统架构

基于人类建议的 Loader+Runtime+Program 三层架构，构建完整的自进化计算机软件系统：

### 2.1 三层架构设计

**Layer 1: Loader-{arch}.exe** [开发中]
- 架构特定的引导程序，负责加载Runtime和Program
- 处理PE/MachO/ELF头和操作系统接口
- 使用 tinycc 编译的 evolver0.c (第零代C语言实现)
- 目标：进化出原生可执行程序替代C语言依赖

**Layer 2: Runtime-{arch}** [规划中] 
- 架构依赖的运行时二进制，实现WASM虚拟机
- 封装硬件架构和ABI接口
- 从.wasm标准格式二次编译生成
- 不包含PE/ELF/MACHO头（由Loader处理）

**Layer 3: Program** [规划中]
- 平台无关的程序逻辑
- 编译为.wasm（WebAssembly标准格式）
- 支持C/C++/Rust等高级语言编译到WASM
- 当前实现：evolver系列自进化程序

## 3. 进化路径规划

### 3.1 真正进化的定义
- **不是随机变异**：进化是有方向性的能力提升，不是随机的代码修改
- **结构性演进**：每一代都应该在架构上有实质性改进
- **能力导向**：适应度基于系统实际能力，而非代码大小
- **自主性增强**：逐步减少对外部工具的依赖

### 3.2 各代进化目标

**第零代 (evolver0.c)** [当前阶段]
- **当前状态**：
  - 已实现词法分析器核心功能
  - 支持完整的C语言预处理指令
  - 支持宏定义和展开（包括可变参数宏）
  - 完整支持字符和字符串字面量（包括转义序列）
  - 支持宽字符和宽字符串字面量
  - 实现了AST节点类型系统与WASM节点类型的统一
- **进化目标**：实现内置机器码生成能力
- **关键能力**：
  - 解析自身 C 代码（进行中）
    - 词法分析器（85%完成）
    - 语法分析器（待开始）
    - AST构建（40%完成）
  - 生成基本的 x86-64/ARM64 机器码
  - 创建可执行文件格式 (ELF/Mach-O)
- **适应度标准**：能否生成并执行自己的机器码版本
- **成功标志**：不再需要 tinycc，可以自我编译

**下一步开发重点**:
1. 完成词法分析器的剩余功能（15%）
   - 完善数字字面量处理（浮点数、长整型等）
   - 添加更多操作符支持
   - 增强错误恢复机制

2. 开始语法分析器开发
   - 设计语法分析器架构
   - 实现表达式解析
   - 添加语句和声明解析
   - 构建完整的AST

3. 实现AST到WASM IR的转换
   - 设计IR表示
   - 实现代码生成器
   - 添加优化通道

**第一代 (evolver1.c)**
- **当前状态**：具备基本自编译能力
- **进化目标**：完善 Loader 层功能
- **关键能力**：
  - 动态加载其他程序模块
  - 处理系统调用接口
  - 内存管理和程序隔离
- **适应度标准**：能否成功加载和执行其他程序
- **成功标志**：成为真正的程序加载器

**第二代 (evolver2.c)**
- **当前状态**：完整的 Loader 功能
- **进化目标**：开始分离 Runtime 层
- **关键能力**：
  - 模块化架构设计
  - 基础的虚拟机框架
  - 简单的字节码执行
- **适应度标准**：Runtime 层的独立性和功能完整性
- **成功标志**：Loader 和 Runtime 成功分离

**第三代及以后**
- 完整的 WASM 虚拟机实现
- 跨平台支持
- 高级语言编译器集成
- 最终实现完全自主的智能系统

### 3.3 进化机制设计

**变异策略**：
- **结构性变异**：修改函数架构、数据结构、算法逻辑
- **能力扩展**：添加新的功能模块和接口
- **优化改进**：提升性能和资源利用效率

**适应度函数**：
- **功能测试**：新功能是否正常工作
- **自主性评估**：对外部依赖的减少程度
- **架构质量**：代码组织和模块化程度
- **性能指标**：执行效率和资源消耗

**选择压力**：
- **自主性压力**：优先选择依赖更少的版本
- **能力压力**：优先选择功能更强的版本
- **稳定性压力**：优先选择更可靠的版本

## 4. 当前开发重点

### 4.1 第零代核心任务
1. **实现简单的 x86-64 机器码生成器**
2. **创建 ELF 文件格式输出**
3. **实现基本的 C 语言子集解析**
4. **建立自我编译和验证机制**

### 4.2 技术路线
- 从最简单的机器码指令开始
- 逐步扩展支持的 C 语言特性
- 建立可靠的测试和验证机制
- 确保每一步都是可工作的改进

# 来自人类的提示

- 除非是代码中的注释，否则默认中文；
- 经常正思反思然后才行动；注意自主思考和执行；
- 从设计角度来解决问题，不要乱简化来回避问题；
如果任务中等以上复杂程度，智能助理需要使用aitasker.md（放在当前代码仓根目录）来进行任务追踪，其中它的内容应该包括：
- ## 任务描述
- ## 动态规划的任务分解图（使用 mermaid 语法，每个节点有：简单ID、精简标题、评估进度百分比），尽量采用非线性并行工作机制，有利于加速进展
- ## 每个节点的具体任务描述（使用 markdown 语法，要有图中的简单ID、精简标题、评估进度百分比、子任务详细描述）
- ## 跟任务相关的经验和上下文累积（以确保智能助理不分神）
- ## 集中用 aitasker.md 管理任务，不用开新的 md 文档
注意不要在 aitasker.md 放太多无用的"历史"信息， 内容要尽量保持 up-to-date