# Self-Evolve AI 项目规划

## 1. 项目愿景

创建一个能够真正自我进化的AI系统，通过代码自我修改、编译和优化实现持续进化，最终目标是实现完全自主的智能系统。

## 来自人类的意见参考

跨架构自举 + AI协同进化

本项目自进化范式：先用Loader+Runtime+Program的结构，通过多代自举和AI驱动的进化，逐步构建出完整的自进化计算机软件系统

核心是一种ASTC的数据结构，整合了WASM/IR/AST的概念，它也是Loader/Runtime/Program的底层逻辑。后面发展高级语言也要由解析器转成它。不过它的压缩率不大，后面可以制作binx二进制码，在执行时才动态把它转ASTC再执行

- c2astc.c 把c语言编译成astc的库
- Loader-{arch}.exe 负责加载Runtime-{arch} + Program.astc，目前主要是操作系统内引导，未来不排除继续演化出操作系统。（注意，第零代的是tinycc编译的C程序loader0.c，之后进化出可执行程序后不再使用）
- Runtime 是架构依赖二进制，封装硬件架构和ABI等，实现ASTC虚拟机。特别注意那些PE/MachO/ELF头不在Runtime而是在Loader上的了
- Program 是平台无关程序（ASTC格式的二进制模块）

注意：Runtime和Program两种编译的二进制是不一样的。Program编译的是ASTC，Runtime编译的是平台适配的二进制（由ASTC再编译成机器码，且不需要PE/ELF/MACHO头）

其中 Loader+Runtime 或 Loader+Runtime+Program 可以根据需要，分开打包或合成打包

## 2. 系统架构

初期基于人类建议的 Loader+Runtime+Program 三层架构，构建完整的自进化计算机软件系统：

### 2.1 三层架构设计

**Layer 1: Loader-{arch}.exe**
- 架构特定的引导程序，负责加载Runtime和Program
- 处理PE/MachO/ELF头和操作系统接口（先对接syscall和libc）
- 使用 tinycc 编译的 evolver0.c (第零代C语言实现)
- 目标：进化出原生可执行程序替代C语言依赖

**Layer 2: Runtime-{arch}**
- 架构依赖的运行时二进制，实现ASTC虚拟机
- 封装硬件架构和ABI接口
- 从.ASTC 格式二次编译生成
- 不包含PE/ELF/MACHO头

**Layer 3: Program**
- 平台无关的程序逻辑
- 编译为.ASTC
- 支持C/C++/Rust等高级语言编译到 ASTC
- 当前实现：evolver系列自进化程序

## 3. 进化路径规划

### 3.1 evolver0 (重新整理完成)

evolver0是第零代自举编译器，经过彻底重新整理，现在具有清晰的架构和完整的ASTC指令集。

**当前进度**: 100% 基础架构完成

**✅ 已完成**:
- ✅ **清晰的三层架构** (src/evolver0/只有3个核心文件)
  - evolver0_loader.c - 加载器组件
  - evolver0_runtime.c - 运行时组件
  - evolver0_program.c - 程序组件
- ✅ **规范的目录结构** (使用src/tools/和src/runtime/公共组件)
- ✅ **完整的ASTC指令集** (基于WebAssembly + C99扩展)
- ✅ **词法语义分离** (token.h + astc.h + 映射机制)
- ✅ **所有组件编译成功** (evolver0_loader_clean.exe等)
- ✅ **抽象设计改进** (消除token和ASTC重复定义)

**🏗️ 架构特点**:
- **干净的evolver0目录** - 不再有混乱的.inc文件
- **公共组件复用** - src/tools/和src/runtime/被正确使用
- **清晰的分层** - 词法层(token) → 语义层(ASTC) → 执行层(runtime)

**🎯 重大成就**:
建立了规范、清晰、可扩展的自举编译系统基础架构，为后续evolver版本奠定坚实基础。

### 3.2 evolver1 (规划中)

evolver1是基于evolver0的第一代改进版本，目标是增强功能和性能。

**当前进度**: 0% (从evolver0重新出发)

**🎯 规划目标**:
- 🎯 基于evolver0的清晰架构进行功能增强
- 🎯 改进ASTC虚拟机性能
- 🎯 增强C语言特性支持
- 🎯 优化编译速度和生成代码质量

**📋 主要任务**:
- 🔄 创建src/evolver1/目录结构
- 🔄 基于src/tools/和src/runtime/构建evolver1组件
- 🔄 实现evolver0→evolver1的自举编译
- 🔄 验证evolver1的功能完整性

**🏗️ 设计原则**:
- **继承evolver0架构** - 保持三层架构的清晰性
- **增量改进** - 在稳定基础上逐步增强
- **复用公共组件** - 最大化利用src/tools/和src/runtime/

### 3.3 evolver2 (规划中)

evolver2是实现100%TinyCC独立的关键版本，目标是完全脱离外部编译器依赖。

**当前进度**: 0% (从evolver0重新出发)

**🎯 核心目标**:
- 🎯 实现100%TinyCC独立编译
- 🎯 支持完整的C99语言特性
- 🎯 生成高质量的可执行文件
- 🎯 建立完整的自举编译链

**📋 关键任务**:
- 🔄 实现真正的代码生成（不再硬编码返回值）
- 🔄 支持printf等标准库函数
- 🔄 建立完整的C运行时环境
- 🔄 实现复杂C程序的正确编译和执行

**🏆 成功标准**:
- **完全独立** - 不依赖任何外部编译器
- **功能完整** - 支持实际C程序编译
- **自举验证** - evolver2能编译自身和整个系统

### 3.4 evolver3 (规划中)

evolver3将专注于完善代码生成和标准库支持，实现真正实用的100%TinyCC独立编译器。

**目标进度**: 100% TinyCC独立

**🎯 核心目标**:
- 🎯 实现真正的代码生成（不再硬编码返回42）
- 🎯 支持printf等基础标准库函数
- 🎯 建立完整的C运行时环境
- 🎯 实现复杂C程序的正确编译

**📋 关键任务**:
- 🔄 完善ASTC到机器码的真实转换
- 🔄 实现基础C标准库（printf, malloc等）
- 🔄 建立系统调用接口
- 🔄 支持更多C语言特性（函数调用、变量、控制流）
- 🔄 验证复杂程序的独立编译

**🏆 成功标准**: 能够编译和运行包含printf的完整C程序，实现真正的evolver3自举

### 3.5 Runtime开发 (已完成)

Runtime模块是连接Loader和Program的关键组件，已成功实现并能执行 ASTC 格式的Program。

**当前进度**: 90%

**已实现功能**:
- ✅ 实现完整的 ASTC 虚拟机
- ✅ 提供操作系统API封装
- ✅ 支持函数调用和变量管理
- ✅ 实现表达式求值引擎
- ✅ 支持复杂AST节点执行

**待完善功能**:
- 🔄 支持JIT编译优化
- 🔄 实现跨平台兼容层
- 🔄 性能优化和内存管理改进

**验证结果**: Runtime成功执行evolver0和evolver1程序，返回正确结果。

### 3.4 Program层开发 (基本完成)

Program层是平台无关的程序逻辑，已使用 ASTC 格式成功实现。

**当前进度**: 80%

**已实现功能**:
- ✅ 实现自我修改和优化的核心逻辑框架
- ✅ 基础自举编译能力
- ✅ evolver0→evolver1→evolver2进化链

**待完善功能**:
- 🔄 开发AI驱动的进化算法
- 🔄 构建自我学习和适应机制
- 🔄 实现真正的文件生成能力



# 来自人类的重要提示（请智能助理尽量参考）：

- 记得：要从设计和整体来分析问题，不要老是想着简化方案和搞太多测试来回避问题
- 记得：除了代码中的注释或字符串常量使用英文，其它情况下尽量精简且精准的中文；.bat要用英文；
- 记得：临时或测试类的文件放到./tests/
- 记得：你要停下来之前先执行 checkin.bat 或 checkin.sh 接收人类留言
- 记得：运行命令要采取timeout机制，以免有些命令或程序会卡住工作流！
- 经常正思反思然后才行动；注意自主思考和执行；
- 从设计角度来解决问题，不要乱简化来回避问题；

如果任务中等以上复杂程度，智能助理需要使用PRD.md（放在当前代码仓根目录）来进行任务追踪，其中它的内容应该包括：
- ## 任务描述
- ## 动态规划的任务分解图（使用 mermaid 语法，每个节点有：简单ID、精简标题、评估进度百分比），尽量采用非线性并行工作机制，有利于加速进展
- ## 每个节点的具体任务描述（使用 markdown 语法，要有图中的简单ID、精简标题、评估进度百分比、子任务详细描述）
- ## 跟任务相关的经验和上下文（以确保智能助理不分神）
- ## 集中用 PRD.md 管理任务，不用开新的 md 文档
- ## 注意不要在 PRD.md 放太多无用的"历史"信息， 内容要尽量保持最新

# 来自智能助理自己总结的经验：

## ⚠️ 开发错误避免指南

### 🚫 **严禁的错误模式**：
1. **逃避核心问题** - 不要创建简化版本(如minimal_test.c)来回避复杂问题
2. **硬编码替代真实实现** - 不要用固定值替代真正的编译/转换结果
3. **忽视现有代码** - 必须理解并使用现有组件(如evolver0_runtime.c)的真实作用
4. **过早宣布成功** - 程序能编译/运行≠功能正确实现

### ✅ **必须遵循的原则**：
1. **深入理解架构** - 分析每个组件的真实作用和依赖关系
2. **直面技术挑战** - 不逃避复杂的实现问题
3. **验证真实功能** - 确保声称的功能真正工作
4. **诚实评估进度** - 实事求是地评估完成度

