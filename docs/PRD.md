# Self-Evolve AI 项目规划

## 1. 项目愿景

创建一个能够真正自我进化的AI系统，通过代码自我修改、编译和优化实现持续进化，最终目标是实现完全自主的智能系统。

## 来自人类的意见参考

跨架构自举 + AI协同进化

本项目自进化范式：先用Loader+Runtime+Program的结构，通过多代自举和AI驱动的进化，逐步构建出完整的自进化计算机软件系统

核心是一种ASTC的数据结构，整合了WASM/IR/AST的概念，它也是Loader/Runtime/Program的底层逻辑。后面发展高级语言也要由解析器转成它。不过它的压缩率不大，后面可以制作binx二进制码，在执行时才动态把它转ASTC再执行

- c2astc.c 把c语言编译成astc的库
- Loader-{arch}.exe 负责加载Runtime-{arch} + Program.astc，目前主要是操作系统内引导，未来不排除继续演化出操作系统。（注意，第零代的是tinycc编译的C程序loader0.c，之后进化出可执行程序后不再使用）
- Runtime 是架构依赖二进制，封装硬件架构和ABI等，实现ASTC虚拟机。特别注意那些PE/MachO/ELF头不在Runtime而是在Loader上的了
- Program 是平台无关程序（ASTC格式的二进制模块）

注意：Runtime和Program两种编译的二进制是不一样的。Program编译的是ASTC，Runtime编译的是平台适配的二进制（由ASTC再编译成机器码，且不需要PE/ELF/MACHO头）

其中 Loader+Runtime 或 Loader+Runtime+Program 可以根据需要，分开打包或合成打包

## 2. 系统架构

初期基于人类建议的 Loader+Runtime+Program 三层架构，构建完整的自进化计算机软件系统：

### 2.1 三层架构设计

**Layer 1: Loader-{arch}.exe**
- 架构特定的引导程序，负责加载Runtime和Program
- 处理PE/MachO/ELF头和操作系统接口（先对接syscall和libc）
- 使用 tinycc 编译的 evolver0.c (第零代C语言实现)
- 目标：进化出原生可执行程序替代C语言依赖

**Layer 2: Runtime-{arch}**
- 架构依赖的运行时二进制，实现ASTC虚拟机
- 封装硬件架构和ABI接口
- 从.ASTC 格式二次编译生成
- 不包含PE/ELF/MACHO头

**Layer 3: Program**
- 平台无关的程序逻辑
- 编译为.ASTC
- 支持C/C++/Rust等高级语言编译到 ASTC
- 当前实现：evolver系列自进化程序

## 3. 进化路径规划

### 3.1 evolver0 (当前阶段)

evolver0是第零代自举编译器，使用C语言编写，由标准C编译器(如TCC)编译。它的目标是实现一个能够编译自身的C编译器从而脱离任何其他编译器依赖）。

**当前进度**: 95% (详见PRD.md)

**已完成**:
- ✅ 完整三层架构实现 (Loader+Runtime+Program) - **重大修复完成**
- ✅ ASTC序列化/反序列化完整基础设施
- ✅ 真正的三层分离架构 (Loader 102KB + Runtime 102KB + Program ASTC)
- ✅ 核心组件代码逻辑梳理完成
- ✅ 扩展AST节点序列化支持覆盖
- ✅ 架构违背问题完全修复

**🔄 待完善功能**:
- 🔄 自举编译功能完善 (当前基础架构已就绪)
- 🔄 ASTC虚拟机指令完整性 (复杂程序执行)
- 🔄 evolver0→evolver1真正自举编译验证

**🎯 重大突破**:
成功实现plan.md要求的真正三层分离架构，解决了之前的架构违背问题。

### 3.2 evolver1 (已完成)

evolver1是第一代自举编译器，已由evolver0成功编译生成。它扩展了evolver0的功能，实现了 ASTC 格式输出。

**当前进度**: 100%

**已实现功能**:
- ✅ 支持更完整的C语言子集
- ✅ 添加优化器模块框架
- ✅ 实现 ASTC 格式输出
- ✅ 支持跨平台交叉编译框架
- ✅ evolver1→evolver2自举编译逻辑

**验证结果**: evolver1成功执行并返回201，证明自举编译链正常工作。

### 3.3 Runtime开发 (已完成)

Runtime模块是连接Loader和Program的关键组件，已成功实现并能执行 ASTC 格式的Program。

**当前进度**: 90%

**已实现功能**:
- ✅ 实现完整的 ASTC 虚拟机
- ✅ 提供操作系统API封装
- ✅ 支持函数调用和变量管理
- ✅ 实现表达式求值引擎
- ✅ 支持复杂AST节点执行

**待完善功能**:
- 🔄 支持JIT编译优化
- 🔄 实现跨平台兼容层
- 🔄 性能优化和内存管理改进

**验证结果**: Runtime成功执行evolver0和evolver1程序，返回正确结果。

### 3.4 Program层开发 (基本完成)

Program层是平台无关的程序逻辑，已使用 ASTC 格式成功实现。

**当前进度**: 80%

**已实现功能**:
- ✅ 实现自我修改和优化的核心逻辑框架
- ✅ 基础自举编译能力
- ✅ evolver0→evolver1→evolver2进化链

**待完善功能**:
- 🔄 开发AI驱动的进化算法
- 🔄 构建自我学习和适应机制
- 🔄 实现真正的文件生成能力

# 来自人类的开发提示（供智能助理参考）

- 记得：要从设计和整体来分析问题，不要老是想着简化方案和搞太多测试来回避问题
- 记得：除了代码中的注释或字符串常量使用英文，其它情况下尽量精简且精准的中文
- 记得：临时或测试类的文件放到./tests/
- 记得：你要停下来之前先执行 checkin.bat 或 checkin.sh 接收人类留言
- 经常正思反思然后才行动；注意自主思考和执行；
- 从设计角度来解决问题，不要乱简化来回避问题；
如果任务中等以上复杂程度，智能助理需要使用PRD.md（放在当前代码仓根目录）来进行任务追踪，其中它的内容应该包括：
- ## 任务描述
- ## 动态规划的任务分解图（使用 mermaid 语法，每个节点有：简单ID、精简标题、评估进度百分比），尽量采用非线性并行工作机制，有利于加速进展
- ## 每个节点的具体任务描述（使用 markdown 语法，要有图中的简单ID、精简标题、评估进度百分比、子任务详细描述）
- ## 跟任务相关的经验和上下文（以确保智能助理不分神）
- ## 集中用 PRD.md 管理任务，不用开新的 md 文档
注意不要在 PRD.md 放太多无用的"历史"信息， 内容要尽量保持最新

## ⚠️ 开发错误避免指南

### 🚫 **严禁的错误模式**：
1. **逃避核心问题** - 不要创建简化版本(如minimal_test.c)来回避复杂问题
2. **硬编码替代真实实现** - 不要用固定值替代真正的编译/转换结果
3. **忽视现有代码** - 必须理解并使用现有组件(如evolver0_runtime.c)的真实作用
4. **过早宣布成功** - 程序能编译/运行≠功能正确实现

### ✅ **必须遵循的原则**：
1. **深入理解架构** - 分析每个组件的真实作用和依赖关系
2. **直面技术挑战** - 不逃避复杂的实现问题
3. **验证真实功能** - 确保声称的功能真正工作
4. **诚实评估进度** - 实事求是地评估完成度

### 🎯 **当前真实状态记录**：
- **runtime.bin生成**: 生成ASTC格式而非真正机器码
- **三层架构**: 基础框架可用，但复杂程序执行失败
- **编译服务**: 框架存在但核心功能未实现
- **TinyCC依赖**: 仍然严重依赖，远未脱离
